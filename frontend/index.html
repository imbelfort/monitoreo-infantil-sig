<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Monitoreo Infantil SIG</title>
  <link rel="stylesheet" href="vendor/leaflet/leaflet.css" />
  <link rel="stylesheet" href="vendor/leaflet-draw/leaflet.draw.css">
  <link rel="stylesheet" href="css/main.css?v=2">
</head>

<body>
  <div class="sidebar">
    <h1>Monitoreo Infantil</h1>
    <p class="descripcion">Inicia sesión como madre o niño para interactuar con el sistema.</p>

    <section class="panel" id="login-panel">
      <h2>Acceso</h2>
      <input type="email" id="login-email" placeholder="Correo" autocomplete="username">
      <input type="password" id="login-pass" placeholder="Contraseña" autocomplete="current-password">
      <button id="btn-login">Ingresar</button>
      <p class="hint">Madre: madre@gmail.com / madre<br>Niño: niño@gmail.com / niño</p>
    </section>

    <section class="panel hidden" id="usuario-panel">
      <h2 id="usuario-rol"></h2>
      <p class="usuario-detalle"></p>
      <button id="btn-logout" class="secundario">Cerrar sesión</button>
    </section>

    <section class="panel hidden" id="madre-panel">
      <h3>Área segura definida por la madre</h3>
      <div class="grupo-botones">
        <button id="btn-dibujar-area">Dibujar/Editar área</button>
        <button id="btn-guardar-area" class="secundario">Guardar área</button>
        <button id="btn-eliminar-area" class="peligro">Eliminar área</button>
      </div>

      <div style="margin-top: 10px; display: flex; align-items: center; gap: 8px;">
        <input type="checkbox" id="check-aplicar-todos" style="width: auto;">
        <label for="check-aplicar-todos" style="font-size: 0.9em; user-select: none;">Aplicar a todos mis niños</label>
      </div>
      <p class="nota">Dibuja un polígono sobre el mapa para delimitar el área segura del niño y presiona "Guardar área".
      </p>

      <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

      <h3>Gestión Escolar</h3>
      <div class="grupo-botones">
        <button id="btn-nueva-unidad" class="secundario">Nueva Unidad Educativa (Mapa)</button>
        <button id="btn-gestion-unidades" class="secundario">Administrar Unidades</button>
      </div>

      <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

      <h3>Mis Niños</h3>
      <div id="lista-ninos" class="lista-ninos"></div>

      <div class="grupo-botones" style="margin-top: 20px;">
        <button id="btn-mostrar-modal-nino" class="primario full-width">Registrar Nuevo Niño</button>
      </div>
    </section>

    <section class="panel hidden" id="map-panel">
      <div id="estado-texto" class="estado estado-pendiente">Inicia sesión para comenzar.</div>
      <!-- Boton simular eliminado -->
      <button id="btn-simular" class="hidden">Simular</button>
      <div class="info">
        <p><strong>Unidad educativa activa:</strong> <span id="unidad-activa">-</span></p>
        <p><strong>Niño monitoreado:</strong> <span id="nino-activo">-</span></p>
      </div>
    </section>
  </div>


  <div id="map"></div>

  <!-- Modal para Código de Vinculación -->
  <div id="modal-codigo" class="modal-overlay hidden">
    <div class="modal-content">
      <span class="close-modal" id="close-modal-codigo">&times;</span>
      <h3>Vincular Dispositivo Móvil</h3>
      <p>Genera un código para vincular la App Móvil del niño.</p>
      <div class="codigo-container">
        <span id="codigo-display" class="codigo">- - - - - -</span>
      </div>
      <div class="modal-actions">
        <button id="btn-generar-codigo">Generar Nuevo Código</button>
      </div>
      <p class="nota">Ingresa este código en la aplicación móvil del niño.</p>
    </div>
  </div>

  <!-- Modal para Registrar Nuevo Niño -->
  <div id="modal-nuevo-nino" class="modal-overlay hidden">
    <div class="modal-content">
      <span class="close-modal" id="close-modal-nino">&times;</span>
      <h3>Registrar Nuevo Niño</h3>
      <div style="display: flex; flex-direction: column; gap: 10px; text-align: left;">
        <label>Nombre:</label>
        <input type="text" id="new-nino-nombre" placeholder="Nombre">

        <label>Apellidos:</label>
        <input type="text" id="new-nino-apellidos" placeholder="Apellidos">

        <label>Unidad Educativa:</label>
        <select id="new-nino-unidad" style="width: 100%;"></select>

        <label>Observaciones:</label>
        <input type="text" id="new-nino-obs" placeholder="Alergias, notas...">
      </div>
      <div class="modal-actions">
        <button id="btn-guardar-nino">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Modal Gestion Unidades -->
  <div id="modal-gestion-unidades" class="modal-overlay hidden">
    <div class="modal-content">
      <span class="close-modal" id="close-modal-gestion">&times;</span>
      <h3>Administrar Unidades Educativas</h3>
      <div id="lista-unidades-gestion"
        style="max-height: 300px; overflow-y: auto; text-align: left; border: 1px solid #eee; padding: 10px; margin-bottom: 10px;">
        <!-- Lista dinamica -->
      </div>
      <div class="modal-actions">
        <button onclick="document.getElementById('modal-gestion-unidades').classList.add('hidden')">Cerrar</button>
      </div>
    </div>
  </div>


  <!-- Modal para Nueva Unidad (Nombre) -->
  <div id="modal-nueva-unidad" class="modal-overlay hidden">
    <div class="modal-content">
      <span class="close-modal" id="close-modal-unidad">&times;</span>
      <h3>Nueva Unidad Educativa</h3>
      <p>Has dibujado el área. Ahora ingresa los datos.</p>
      <div style="display: flex; flex-direction: column; gap: 10px; text-align: left;">
        <label>Nombre de la Unidad:</label>
        <input type="text" id="new-unidad-nombre" placeholder="Ej. Colegio Don Bosco">
        <label>Dirección (Opcional):</label>
        <input type="text" id="new-unidad-direccion" placeholder="Av. Principal #123">
      </div>
      <div class="modal-actions">
        <button id="btn-guardar-unidad">Guardar Unidad</button>
      </div>
    </div>
  </div>

  <script defer src="vendor/leaflet/leaflet.js"></script>
  <script defer src="vendor/leaflet-draw/leaflet.draw.js"></script>

  <!-- IMPORTANTE: main.js como módulo -->
  <script type="module" src="js/main.js?v=2"></script>

</body>

</html>


<!-- <!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Monitoreo Infantil SIG</title>
  <link rel="stylesheet" href="vendor/leaflet/leaflet.css" />
  <link rel="stylesheet" href="vendor/leaflet-draw/leaflet.draw.css">
  <link rel="stylesheet" href="css/main.css">
</head>

<body>
  <div class="sidebar">
    <h1>Monitoreo Infantil</h1>
    <p class="descripcion">Inicia sesión como madre o niño para interactuar con el sistema.</p>

    <section class="panel" id="login-panel">
      <h2>Acceso</h2>
      <input type="email" id="login-email" placeholder="Correo" autocomplete="username">
      <input type="password" id="login-pass" placeholder="Contraseña" autocomplete="current-password">
      <button id="btn-login">Ingresar</button>
      <p class="hint">Madre: madre@gmail.com / madre<br>Niño: niño@gmail.com / niño</p>
    </section>

    <section class="panel hidden" id="usuario-panel">
      <h2 id="usuario-rol"></h2>
      <p class="usuario-detalle"></p>
      <button id="btn-logout" class="secundario">Cerrar sesión</button>
    </section>

    <section class="panel hidden" id="madre-panel">
      <h3>Área segura definida por la madre</h3>
      <div class="grupo-botones">
        <button id="btn-dibujar-area">Dibujar/Editar área</button>
        <button id="btn-guardar-area" class="secundario">Guardar área</button>
        <button id="btn-eliminar-area" class="peligro">Eliminar área</button>
      </div>
      <p class="nota">Dibuja un polígono sobre el mapa para delimitar el área segura del niño y presiona "Guardar área".</p>
    </section>

    <section class="panel hidden" id="map-panel">
      <div id="estado-texto" class="estado estado-pendiente">Inicia sesión para comenzar.</div>
      <button id="btn-simular">Simular nueva posición</button>
      <div class="info">
        <p><strong>Unidad educativa activa:</strong> <span id="unidad-activa">-</span></p>
        <p><strong>Niño monitoreado:</strong> <span id="nino-activo">-</span></p>
      </div>
    </section>
  </div>
  <div id="map"></div>

  <script defer src="vendor/leaflet/leaflet.js"></script>
  <script defer src="vendor/leaflet-draw/leaflet.draw.js"></script>
  <script defer src="js/main.js"></script>
</body>

</html> -->